<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Air Hockey</title>
    <style>
      * { padding: 0; margin: 0; }
      canvas { background: #eee; display: block; margin: 0 auto }
      h1 {
        font-family: 'Bungee Shade', cursive;
      }
      h2, h3 {
        font-family: 'Bungee', cursive;
      }
    </style>
    <link href="https://fonts.googleapis.com/css?family=Bungee+Shade" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Bungee" rel="stylesheet">
  </head>
  <body>
    <h1>Air Hockey</h1>
    <canvas id="myCanvas" width= "480" height="320"></canvas>
    <script type="text/javascript">
      var canvas = document.getElementById("myCanvas");
      var ctx = canvas.getContext("2d");
      var x = canvas.width / 2
      var y = canvas.height / 2
      var dx = 1.125;
      var dy = -1.125;
      var puckRadius = 5;

      var goalOneHeight = 70;
      var goalOneWidth = 3

      var goalTwoHeight = 70;
      var goalTwoWidth = 3;

      var blockerOneHeight = 45;
      var blockerOneWidth = 10;
      var blockerOneY = (canvas.height - blockerOneHeight) / 2;
      var blockerOneX = 0;

      var blockerTwoHeight = 45;
      var blockerTwoWidth = 10;
      var blockerTwoY = (canvas.height - blockerTwoHeight) / 2;
      var blockerTwoX = canvas.width - blockerTwoWidth;

      var upOnePressed = false;
      var downOnePressed = false;
      var leftOnePressed = false;
      var rightOnePressed = false;

      var upTwoPressed = false;
      var downTwoPressed = false;
      var leftTwoPressed = false;
      var rightTwoPressed = false;

      document.addEventListener("keydown", keyDownHandler, false);
      document.addEventListener("keyup", keyUpHandler, false)

      function keyDownHandler(e) {
        if (e.key == "w") {
          upOnePressed = true;
        } else if (e.key == "s") {
          downOnePressed = true;
        } else if (e.key == "a") {
          leftOnePressed = true;
        } else if (e.key == "d") {
          rightOnePressed = true;
        }

        if (e.key == "ArrowUp") {
          upTwoPressed = true;
        } else if (e.key == "ArrowDown") {
          downTwoPressed = true;
        } else if (e.key == "ArrowLeft") {
          leftTwoPressed = true;
        } else if (e.key == "ArrowRight") {
          rightTwoPressed = true;
        }
      }

      function keyUpHandler(e) {
        if (e.key == "w") {
          upOnePressed = false;
        } else if (e.key == "s") {
          downOnePressed = false;
        } else if (e.key == "a") {
          leftOnePressed = false;
        } else if (e.key == "d") {
          rightOnePressed = false;
        }

        if (e.key == "ArrowUp") {
          upTwoPressed = false;
        } else if (e.key == "ArrowDown") {
          downTwoPressed = false;
        } else if (e.key == "ArrowLeft") {
          leftTwoPressed = false;
        } else if (e.key == "ArrowRight") {
          rightTwoPressed = false;
        }
      }

      function drawPuck() {
        ctx.beginPath();
        ctx.arc(x, y, puckRadius, 0, Math.PI * 2);
        ctx.fillStyle = "black";
        ctx.fill();
        ctx.closePath();
      }

      function drawGoalOne() {
        ctx.beginPath();
        ctx.rect(0, (canvas.height - goalOneHeight) / 2, goalOneWidth, goalOneHeight);
        ctx.fillStyle = "lightblue";
        ctx.fill();
        ctx.closePath();
      }

      function drawGoalTwo() {
        ctx.beginPath();
        ctx.rect(canvas.width - goalTwoWidth, (canvas.height - goalTwoHeight) / 2, goalTwoWidth, goalTwoHeight);
        ctx.fillStyle = "lightblue";
        ctx.fill();
        ctx.closePath();
      }

      function drawBlockerOne() {
        ctx.beginPath();
        ctx.rect(blockerOneX, blockerOneY, blockerOneWidth, blockerOneHeight )
        ctx.fillStyle = "blue"
        ctx.fill();
        ctx.closePath();
      }

      function drawBlockerTwo() {
        ctx.beginPath();
        ctx.rect(blockerTwoX, blockerTwoY, blockerTwoWidth, blockerTwoHeight )
        ctx.fillStyle = "red"
        ctx.fill();
        ctx.closePath();
      }

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawPuck();
        drawGoalOne();
        drawGoalTwo();
        drawBlockerOne();
        drawBlockerTwo();

        if (y > 125 && y < 195) {
          if (x < goalOneWidth + puckRadius) {
            alert("Red Scores!");
            document.location.reload();
            clearInterval(interval);
          } else if (x + puckRadius + goalTwoWidth > canvas.width) {
            alert("Blue Scores!");
            document.location.reload();
            clearInterval(interval);
          }
        }

        if (x + dx < blockerOneX && x + dx > blockerOneX - blockerOneWidth) {
          if (y + dy > blockerOneY && y + dy < blockerOneY + (35)) {
            dx = -dx;
          }
        }

        if (x < blockerTwoX && x > blockerTwoX - blockerTwoWidth) {
          if (y + dy > blockerTwoY && y + dy < blockerTwoY + (35)) {
            dx = -dx;
          }
        }

        if (x + dx > canvas.width - puckRadius || x + dx < puckRadius) {
          dx = -dx;
        }
        if (y + dy > canvas.height - puckRadius || y + dy < puckRadius) {
          dy = -dy;
        }

        if (upOnePressed && blockerOneY > 0) {
          blockerOneY -= 2;
        } else if (downOnePressed && blockerOneY < canvas.height - blockerOneHeight) {
          blockerOneY += 2;
        } else if (leftOnePressed && blockerOneX > 0) {
          blockerOneX -= 2;
        } else if (rightOnePressed && blockerOneX < (canvas.width / 2) - blockerOneWidth) {
          blockerOneX += 2;
        }

        if (upTwoPressed && blockerTwoY > 0) {
          blockerTwoY -= 2;
        } else if (downTwoPressed && blockerTwoY < canvas.height - blockerTwoHeight) {
          blockerTwoY += 2;
        } else if (leftTwoPressed && blockerTwoX > (canvas.width / 2) + blockerTwoWidth) {
          blockerTwoX -= 2;
        } else if (rightTwoPressed && blockerTwoX < (canvas.width - blockerTwoWidth)) {
          blockerTwoX += 2;
        }

        x += dx;
        y += dy;
      }



      var interval = setInterval(draw, 2);
    </script>
    <h2>HOW TO PLAY</h2>
    <p>Be the first player to hit the puck into the opponent's goal. Use the
      following controls to position your blocker in order to bounce the puck
      towards your opponent's goal.</p>
    <h3>Blue Player Controls</h3>

    <h3>Red Player Contorls</h3>
    <img src="./img/keyboard_keys.png"/>
  </body>
</html>
